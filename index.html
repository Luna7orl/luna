<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mensaje Especial</title>
  <style>
    :root {
      --azul-pastel: #B0E0E6;
      --amarillo-bajo: #FFD700;
      --amarillo-hover: #FFC000;
    }
    
    body {
      font-family: 'Arial', sans-serif;
      background-color: var(--azul-pastel);
      padding: 20px;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      text-align: center;
      line-height: 1.6;
    }
    
    .container {
      background: rgba(255, 255, 255, 0.95);
      padding: 30px;
      border-radius: 15px;
      max-width: 600px;
      width: 90%;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      margin: 20px auto;
      animation: fadeIn 0.5s ease-in-out;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    h1, h2, h3 {
      color: var(--amarillo-bajo);
      text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
      margin-bottom: 20px;
    }
    
    .texto-mensaje {
      color: #333;
      text-align: left;
      margin: 20px 0;
      font-size: 1.1em;
    }
    
    #imagen-dedo img {
      width: 100%;
      max-width: 400px;
      border-radius: 10px;
      margin: 15px auto;
      border: 3px solid var(--amarillo-bajo);
      display: block;
    }
    
    input, button {
      width: 100%;
      padding: 12px;
      margin-top: 15px;
      border: 2px solid var(--amarillo-bajo);
      border-radius: 8px;
      font-size: 16px;
      box-sizing: border-box;
    }
    
    input:focus {
      outline: none;
      border-color: var(--amarillo-hover);
      box-shadow: 0 0 5px rgba(255, 208, 0, 0.5);
    }
    
    button {
      background-color: var(--amarillo-bajo);
      color: #333;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s;
      border: none;
    }
    
    button:hover {
      background-color: var(--amarillo-hover);
      transform: translateY(-2px);
    }
    
    .botones-container {
      display: flex;
      gap: 15px;
      margin-top: 25px;
      justify-content: center;
      flex-wrap: wrap;
    }
    
    .botones-container button {
      flex: 1;
      min-width: 120px;
    }
    
    #mensaje-error {
      color: #d9534f;
      display: none;
      margin-top: 10px;
      font-weight: bold;
      animation: shake 0.5s;
    }
    
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      75% { transform: translateX(5px); }
    }
    
    /* Ocultar todas las secciones excepto login inicialmente */
    #formulario, #thanks, #mensaje-secreto, #imagen-dedo, 
    #disculpa-inicial, #disculpa-parte1, #disculpa-parte2, #final {
      display: none;
    }
  </style>
</head>
<body>

  <!-- Pantalla de contraseña -->
  <div id="login" class="container">
    <h2>Ingresa la contraseña</h2>
    <input type="password" id="password" placeholder="Contraseña" required>
    <button id="btn-entrar">Entrar</button>
    <p id="mensaje-error">Contraseña incorrecta. Intenta nuevamente.</p>
  </div>

  <!-- Formulario -->
  <div id="formulario" class="container">
    <h2>Formulario de Registro</h2>
    <form id="myForm">
      <label for="name">Nombre:</label>
      <input type="text" name="name" id="name" required placeholder="Tu nombre" minlength="2">
      <button type="button" id="btn-enviar">Enviar</button>
      
      <!-- Configuración para FormSubmit -->
      <input type="hidden" name="_subject" value="Alguien ha entrado a tu página especial">
      <input type="hidden" name="_template" value="table">
      <input type="hidden" name="_next" value="https://luna7orl.github.io/luna/thanks.html">
      <input type="text" name="_honey" style="display:none">
      <input type="hidden" name="_captcha" value="false">
    </form>
  </div>

  <!-- Resto de las secciones (manteniendo el mismo contenido) -->
  <!-- ... -->

  <script>
    // Variables globales
    const nombreUsuario = {
      value: '',
      set: function(nombre) {
        this.value = nombre.trim();
        localStorage.setItem('nombreUsuario', this.value);
      },
      get: function() {
        return this.value || localStorage.getItem('nombreUsuario') || 'Anónimo';
      }
    };
    
    // Elementos del DOM
    const elementos = {
      login: document.getElementById('login'),
      formulario: document.getElementById('formulario'),
      thanks: document.getElementById('thanks'),
      password: document.getElementById('password'),
      name: document.getElementById('name'),
      btnEntrar: document.getElementById('btn-entrar'),
      btnEnviar: document.getElementById('btn-enviar'),
      errorMsg: document.getElementById('mensaje-error'),
      thankMessage: document.getElementById('thankMessage')
    };
    
    // Inicialización
    document.addEventListener('DOMContentLoaded', function() {
      // Event listeners mejorados
      elementos.btnEntrar.addEventListener('click', verificarContrasena);
      elementos.btnEnviar.addEventListener('click', enviarFormulario);
      elementos.password.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') verificarContrasena();
      });
      elementos.name.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') enviarFormulario();
      });
      
      // Cargar nombre si existe
      if (localStorage.getItem('nombreUsuario')) {
        elementos.name.value = localStorage.getItem('nombreUsuario');
      }
    });
    
    // Función mejorada para verificar contraseña
    function verificarContrasena() {
      const pass = elementos.password.value.trim().toLowerCase();
      
      if (pass === 'pequitas') {
        elementos.login.style.display = 'none';
        elementos.formulario.style.display = 'block';
        elementos.errorMsg.style.display = 'none';
        elementos.name.focus();
      } else {
        elementos.errorMsg.style.display = 'block';
        elementos.password.value = '';
        elementos.password.focus();
      }
    }
    
    // Función para enviar formulario
    function enviarFormulario() {
      const nombre = elementos.name.value.trim();
      
      if (nombre.length < 2) {
        alert('Por favor ingresa un nombre válido (mínimo 2 caracteres)');
        elementos.name.focus();
        return;
      }
      
      nombreUsuario.set(nombre);
      elementos.thankMessage.textContent = Gracias, ${nombreUsuario.get()}, por estar aquí.;
      
      // Enviar formulario
      const formData = new FormData(document.getElementById('myForm'));
      enviarDatos('https://formsubmit.co/axelluneta76@gmail.com', formData);
      
      // Mostrar siguiente sección
      elementos.formulario.style.display = 'none';
      elementos.thanks.style.display = 'block';
    }
    
    // Función genérica para enviar datos
    function enviarDatos(url, data) {
      fetch(url, {
        method: 'POST',
        body: data
      })
      .then(response => {
        if (!response.ok) throw new Error('Error en la red');
        return response.json();
      })
      .then(data => console.log('Éxito:', data))
      .catch(error => console.error('Error:', error));
    }
    
    // Funciones de navegación (mostrarDisculpaInicial, mostrarDisculpaParte1, etc.)
    // ... (manteniendo la misma lógica pero con mejores prácticas)
    
    // Función para manejar la opción seleccionada
    function opcionSeleccionada(opcion) {
      const mensajeFinal = document.getElementById('mensaje-final');
      const respuesta = opcion === 'seguir' ? 'Seguir contando historia' : 'Ya nada dota';
      
      // Mostrar mensaje final
      document.getElementById("disculpa-parte2").style.display = "none";
      document.getElementById("final").style.display = "block";
      mensajeFinal.textContent = opcion === 'seguir' 
        ? "¡La historia continuará!" 
        : "Gracias por llegar hasta aquí";
      
      // Enviar respuesta
      const data = new FormData();
      data.append('name', nombreUsuario.get());
      data.append('respuesta', respuesta);
      data.append('_subject', 'Respuesta recibida en tu página especial');
      
      enviarDatos('https://formsubmit.co/axelluneta76@gmail.com', data);
    }
  </script>
</body>
</html>
